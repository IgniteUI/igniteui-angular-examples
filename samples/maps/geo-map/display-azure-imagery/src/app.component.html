<div class="container sample center" 
     style="display:flex; flex-direction:column; align-items:center; gap:2px;">

  <!-- Button + Select on the same line -->
  <div class="controls-row" style="display:flex; gap:8px; align-items:center;">
    <!-- Button opens the API key dialog -->
    <button igxButton="contained" (click)="openDialog()">Enter your Azure Maps API Key</button>

    <!-- Select map style -->
    <igx-select #styleSelect
                placeholder="Choose Azure Imagery"
                [(ngModel)]="selectedStyle"
                (selectionChanging)="onStyleChange($event.newSelection?.value)">
      <igx-select-item *ngFor="let s of styleOptions" [value]="s">
        <span>{{ s }}</span>
      </igx-select-item>
    </igx-select>
  </div>

  <!-- Azure Key Dialog with Form -->
  <igx-dialog #dialog [modal]="true" [width]="'400px'" [height]="'auto'">
    <form #keyForm="ngForm" (ngSubmit)="onSubmit(keyForm)">
      <div class="dialog-header">
        <h3>Azure Key</h3>
      </div>

      <div class="dialog-content" style="display:flex; flex-direction:column; gap:12px;">
        <label for="azureKeyInput">An image will remain visible when no key is entered.</label>
        <input
          id="azureKeyInput"
          name="azureKeyInput"
          [(ngModel)]="apiKeyInputValue"
          type="text"
          placeholder="Enter your key"
          required />
      </div>

      <div class="dialog-actions" style="display:flex; justify-content:flex-end; gap:8px; margin-top:1rem;">
        <button type="button" (click)="onReset(keyForm)">Clear</button>
        <button type="submit">Submit</button>
      </div>
    </form>
  </igx-dialog>

  <!-- Map container -->
  <div class="map-container" style="width:100%; display:flex; justify-content:center; margin-top:2px;">
  <!-- Show placeholder image on top -->
  <img *ngIf="!apiKey" class="placeholder" [src]="previewImageSrc" alt="Map Imagery"
       style="position:absolute; z-index:1; width:100%; height:500px; object-fit:cover;" />

  <!-- Always render map underneath -->
  <igx-geographic-map #map [height]="'500px'" [width]="'100%'" style="position:relative; z-index:0;">
    <igx-geographic-tile-series #tileSeries></igx-geographic-tile-series>
  </igx-geographic-map>
</div>
</div>
